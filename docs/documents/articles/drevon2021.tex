%%%%necessary for acta crystallographica
\newcommand{\figsca}{0.45}
\section{Introduction}

\subsection{Motivation}
Since the first experimental demonstration of electron diffraction in 1928,
theory of dynamical diffraction has been developed~\cite{Bethe1928,CowleyBook}.
Besides, multiple scattering~\cite{Korringa1947,Kohn1954,Korringa1994,Dederichs1971}
In electro nmicroscopy, theories have also been proposed providing an intuitive picture
dynamical diffraction to describe channeling in crystals~\cite{VanDyck1995}.
has also extensively been studied in solid state physics over the 20th century.
Studying dynamical theory is unavoidable when it comes to electron-atom interaction,
since even at very high electron energies commonly used in modern transmission
electron microscopes, the interaction is so strong that the kinematic
theory of diffraction is not theoretically valid for crystals thicker than a
few nm\cite{GlaeserDowning1993,SubramanianSpence2015}. In practice, crystal
growth cannot be controlled to such a degree of accuracy and nano-crystals
of organic compounds are usually on the order of tens to hundreads of nanometers.
This is known as a challenging aspect of high energy electron diffraction (HEED) as it
should significantly complicate the structure determination process.
However, successfull structure determination based on the standard kinematic
theory used in X-ray diffraction have regularly been demonstrated over the
past 10 years\cite{Nannenga2014,Nannenga2019} suggesting that dynamical diffraction may
not affect the diffraction intensities as much as the theory suggests.
Although, dynamical refinement based structure determination~\cite{Palatinus2013} usually
leads to better intensity predictions~\cite{Gemmi2019b}, the agreement
between theory and experiment is still significantly worse than those obtained
for X-rays~\cite{Oleynikov2007}. It is therefore crucial to develop more
accurate models of electron diffraction by crystals.

\subsection{state of the art}
The multislice(MS)~\cite{CowleyMoodie1957} and Blochwave(BW)~\cite{Bethe1928}
approaches are the most popular methods for simulating scattering of high energy
electrons in crystals.
The MS is particularly well suited for solving large structures as it involves
successive convolutions which can be very efficiently computed with the Fast
Fourier Transform(FFT)~\cite{Ishizuka1977}. To avoid aliasing transverse periodic
boundary conditions must be met which is only possible for orthorombic
structures in zone axis orientations. Although small beam tilt can also be
used~\cite{Ishizuka1982,ChenDyck1997}, simluations with arbitrary orientations
must be performed by simulating a full crystal with added zero padding. This
can quickly become computationnally challenging.

On the other hand, BW method can simulate small structures in any arbitrary
orientations. Although some efficient implementation~\cite{Zuo1995} can simulate
moderately large structures, BW cannot be applied to large structures due to
the unfavorable scaling behaviour of the matrix diagonalization involved.
Non periodic structures, defects and solvent scattering can hardly be modelled
either with this method.

% Both approach can handle coherent inelastic scattering through the use of
% an imaginary part on the potential. This however does not account for the
% loss of coherency induced by inelastic scattering which may have dramatic
% impact on the dynamical diffraction~\cite{Latychevskaia2019}.
Some very efficient implementations are available~\cite{Ophus2017} for convergent beam
electron diffraction (CBED) and ~\cite{Allen2015}.
Implementations with full modelling capabilities one while computationnally efficient,
specifically designed at continuous electron diffraction (CED) of large organic
structure would be ideal for macromolecular structure determination.



\subsection{Contribution and outline}

The purpose of this paper is to propose an alternative real space approach
to the scattering of fast electrons by light-atom structures based on
the T-matrix formalism.
The T-matrix has been extensively applied to various areas of physics including
electromagnetics~\cite{Hamid1990,Hamid1990_b,Eremin1995}, optics~\cite{Moine2005}
and acoustics~\cite{Silva2012,Godin2011}.
Although not computationnally competitive with multislice
for large systems, this approach provides an exact solution to Schr{\"o}dinger's
equation for an assemble of spherically symmetric effective atomic potentials in
the independent atom model (IAM).
An intuitive understanding of multiple scattering in the forward scattering
approximation is presented and compared with existing intepretations.
The validity of the forward scattering approximation and the phase grating
approximation used by multislice are then discussed.
Conclusions are drawn and extensions of this approach to account for incoherent
inelastic scattering are outlined.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Theory
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Theory}

The problem of the scattering of fast electrons by an assembly of atoms is
found by solving Schr{\"o}odinger's equation :
%
\begin{equation}\label{eq:schro}
  \left[-\frac{\hbar^2}{2m_e}\grad_{\bb r}^2 - eV(\bb r) \right] \Psi = E\Psi
\end{equation}
%
where $\hbar$ is plank's constant, $m_e$ the mass of the electron,
$e$ the elementary charge, $V(\bb r)$ is the spatially varying electrostatic
potential created by the atoms and $E$ the energy of the incident electrons.
The wave function is sought as a sum of an incident wave $\Psi^{(i)}$
and a scattered wave $\Psi^{(s)}$.

\subsection{T-matrix formulation}

\begin{figure}[h!]
  \centering
  \includegraphics[height=\figsca\textheight]{figures/Tmatrix.png}
\caption{The problem solved by the T-matrix}\label{fig:Tmatrix}
\end{figure}

In its standard form, the T-matrix solves for the case where the electrostatic
potential is uniform constant inside non overlapping spheres and the
incident wave is described by a plane wave of wavenumber $k_0=2\pi/\lambda$
(optics convention).
The setup shown in figure~\ref{fig:Tmatrix}.
The formulation is well established and the theory is outlined for the purpose
of introducing the forward multiple scattering approximation picture.

In each domain, the problem is reduced to Helmholtz's equation
in spherical coordinates  :
%
\begin{eqnarray*}
  \grad_{\bb r_p}^2\Psi + k_p^2 \Psi &=& 0\\
  k_p &=& k_0n_p\\
  k_0 &=& \sqrt{\frac{2m_eE}{\hbar^2}}\\
  n_p &=& \sqrt{1+\frac{V_p}{E}}
\end{eqnarray*}
%
where $V_p\ge 0$ is the constant attractive potential inside sphere $p$ of radius
$a_p$ centered at $\bb d_p$, $k_p$ the wave number inside the sphere and $n_p$
can be referred to as the refractive index by analogy with optics.
The scattered wave function inside and outside of sphere $p$ can then be expressed
as :
%
\begin{eqnarray*}
  \Psi_p^{(in )}(\bb r_p) &=& \sum_{l=0}^{\infty}j_l(k_pr_p)\sum_{m=-l}^{m=l}a_{p;lm}Y_l^m(\theta_p,\phi_p)\\
  \Psi_p^{(out)}(\bb r_p) &=& \sum_{l=0}^{\infty}\hl(k_0r_p)\sum_{m=-l}^{m=l}b_{p;lm}Y_l^m(\theta_p,\phi_p)\\
\end{eqnarray*}
%
where $p=1..N$,
$j_l$ and $\hl$ are the spherical Bessel and Hankel functions of the first
kind, $Y_l^m$ are the spherical harmonics or order $l$ and azimuthal order $m$.
Note that these equations are expressed in the reference frame of each
sphere $p$ hence the use of variable $\bb r_p$.

The unknown coefficients $a_{p;lm}$, $b_{p;lm}$ are found by imposing the
continuity of the wave function and its radial derivative at the surface of each
sphere $p$ :
%
\begin{eqnarray*}
      \Big(\sum_{q=1}^N \Psi_q^{(out)}+\Psi^{(i)}\Big)\big|_{r_p=a_p}
  &=& \Big(\Psi_p^{(in)}\Big)\big|_{r_p=a_p} \\
      \dP_{r_p}\Big(\sum_{q=1}^N \Psi_q^{(out)}+\Psi^{(i)}\Big)\big|_{r_p=a_p}
  &=& \dP_{r_p}\Big(\Psi_p^{(in)}\Big)\big|_{r_p=a_p} \\
\end{eqnarray*}
%
where $f^{(i)}$ is the incident electron wavefunction and $a_p$ the
radius of sphere $p$.

Using the orthogonality of the spherical harmonics
% $\int_{\Omega} Y_{l}^{m}Y_{l'}^{m'*}d\Omega=\delta_{l,l'}\delta_{m,m'}$,
the following linear system yields the unknown coefficients :
%
\begin{eqnarray}
  a_{p;lm} &=& u_{p;l}c_{lm} + u_{p;l}\sum_{q\neq p}^{N} \nonumber\\
    &&~~\sum_{\nu=0}^{\infty}\sum_{\mu=-\nu}^{\mu=\nu}
      a_{\nu,\mu;l,m}^{(out-in)}(\bb d_{pq})b_{q;\nu\mu}\label{eq:aplm}\\
  b_{p;lm} &=& v_{p;l}c_{lm} + v_{p;l} \sum_{q\neq p}^{N}\nonumber\\
    &&~~\sum_{\nu=0}^{\infty}\sum_{\mu=-\nu}^{\mu=\nu}
      a_{\nu,\mu;l,m}^{(out-in)}(\bb d_{pq})b_{q;\nu\mu}\label{eq:bplm}\\\nonumber
\end{eqnarray}
%
where
the translational addition theorem\cite{Dufva2008} has been
used to express the field scattered by sphere $q$ in the reference
frame of sphere $p$, formally written as $f_q^{(out)}(\bb r_p)$.
This operation involves the coupling coefficients
$a_{\nu,\mu;l,m}^{(out-in)}(\bb d_{pq})$
where $\bb d_{pq}=\bb d_q-\bb d_p$.
%
% \begin{eqnarray*}
%   d_{pq}  &=& ||\bb d_q-\bb d_p|| \\
%   \theta_{pq} &=& \arccos\left(\frac{z_q-z_p}{d_{pq} }\right)\\
%   \phi_{pq}   &=& \arctan\left(\frac{y_q-y_p}{x_q-x_p}\right)\\
% \end{eqnarray*}
%

The coefficient $c_{lm}$ are related to the incident wave.
In the case of a plane wave $e^{j\bb k_0\cdot\bb r}$, $j=\sqrt{-1}$,
the addition theorem is used to expand the plane wave on
the family basis os Spherical Bessel soluions :
\begin{eqnarray*}
  c_{lm}  &=& 4\pi j^l Y_l^{m*}\left(\theta_i,\phi_a\right)e_p\\
  e_p     &=& e^{jk_0d_p\zeta_p}\\
  \zeta_p &=& \sin(\Theta_p)\sin(\Phi_p)\sin(\theta_i)+
              \cos(\Theta_p)\cos(\theta_i)\\
\end{eqnarray*}
%
where $d_p,\Theta_p,\Phi_p$ being the spherical coordinates of the
centre of sphere $p$ in the global coordinate system,
$0\le\theta_i\le\pi$ is the angle of incidence with respect to
the $\bb e_z$ axis, $\phi_i=\pi/2$ since the propagation is in the $(y,z)$
plane and $e_p$ is the phase offset at sphere $p$.
The different notations as illustrated on figure~\ref{fig:Tmatrix}.

The coefficients $u_{p;l}$ and $v_{p;l}$ are expressed as :
\begin{eqnarray*}
  u_{p;l} &=& \frac{h_l^{'}(k_0a_p)j_l(k_0a_p) - h_l(k_0a_p)j_l(k_0a_p)^{'}}
    {j_l(k_pa_p)h_l^{'}(k_0a_p)-n_pj_l^{'}(k_pad_p)h_l(k_0a_p)} \\
  v_{p;l} &=& \frac{n_pj_l^{'}(k_pa_p)j_l(k_0a_p) - j_l(k_pa_p)j_l^{'}(k_0a_p)}
    {j_l(k_pa_p)h_l^{'}(k_0a_p)-n_pj_l^{'}(k_pa_p)h_l(k_0a_p)} \\
\end{eqnarray*}
%
where $z_l^{'}=\dP_{\rho}z_l(\rho)$.

Equations~(\ref{eq:aplm},\ref{eq:bplm}) can be written in a matrix notation :
%
\begin{equation}\label{eq:Tsystem}
  \big(\bb I - \bb T \big)\bb A = \bb L
\end{equation}
%
where
$\bb I$ is the identity matrix,
$\bb A$ is the unknown vector coefficients,
$\bb L$ the incident wave right hand side and
$\bb T$ is the cross-coupling matrix.


\subsection{Far field and scattering cross section}
In electron crystallography, the diffraction pattern of particular
interest which is recorded in the far field. Using the asymptotic
behaviour $\hl(k_0r_p)\approx (-j)^{l+1}\frac{e^{jk_0r_p}}{k_0r_p}$
and since $\theta_p\approx\theta$,$\phi_p\approx\phi$
the far field scattering amplitude $f_p(\theta,\phi)$ from sphere $p$ can
be written as :
%
\begin{equation}\label{eq:fp_theta}
  f_p(\theta,\phi) = \sum_{l=0}^{\infty}\sum_{m=-l}^{l} (-j)^{l+1}b_{p;lm}Y_l^m(\theta,\phi)
\end{equation}
%
The total scattering amplitude is the sum of the contribution from all
individual spheres.
Since in the far field, $r_p\approx r-\bb d_p\cdot\bb e_r$ :
%
\begin{equation}\label{eq:f_theta}
  f(\theta,\phi) = \sum_{p=1}^{N} f_p(\theta,\phi)e^{-jk_0\bb e_r\cdot\bb d_p}
\end{equation}
%

The normalized differential scattering cross section is defined as :
%
\begin{equation}\label{eq:sigma}
  \frac{\sigma(\theta,\phi)}{\pi a_p^2}
  = \frac{4\pi r^2}{\pi a_p^2}
    \norm{\frac{\Psi^{(s)}(r,\theta,\phi)|}{\Psi^{(i)}(r,\theta,\phi)}}^2
  = \frac{4\bigl|f(\theta,\phi)\bigr|^2}{\left(k_0a_p\right)^2}
\end{equation}
%
where we have used
$\Psi^{(s)}(r,\theta,\phi) \underset{r\rightarrow\infty}\approx \frac{e^{jk_0r}}{k_0r}f(\theta,\phi)$.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Forward Multiple Scattering
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Real space forward multiple scattering picture}

\subsection{T-matrix forward multiple scattering approximations}
Expression~\eqref{eq:Tsystem} is a convenient way to write the system as it
readily identifies $\bb L$ as the solution to the uncoupled problem.
Indeed,
$a_{p;lm}=c_{lm}u_{p;l}$,
$b_{p;lm}=c_{lm}v_{p;l}$
are them well known analytical solutions of Mie scattering by a soft sphere.

The cross-coupling matrix $\bb T$ accounts for multiple scattering effects.
If $\bb A$ is written $\bb A=\left(..a_{p;lm},b_{p;lm}...\right)^T$,
$\square^T$ denoting transposition, then $\bb T$ is block diagonal :
%
\begin{equation*}
  \bb T =\left[
    \begin{array}{cccc}
      \bb 0      & ..~\bb T_{1q}~.. & ..~\bb T_{1p}~.. & \bb T_{1N}\\
      \bb T_{q1} & ..~\bb 0     ~.. & ..~\bb T_{qp}~.. & \bb T_{qN}\\
      \bb T_{p1} & ..~\bb T_{pq}~.. & ..~\bb 0     ~.. & \bb T_{pN}\\
      \bb T_{N1} & ..~\bb T_{Nq}~.. & ..~\bb T_{Np}~.. & \bb 0     \\
    \end{array}\right]
\end{equation*}
%
where $\bb T_{pq}$ represents the scattering from sphere $p$ due to the
scattering from sphere $q$. If the problem is fully coupled, the scattering
from sphere $p$ affects scattering from sphere $q$ and vice versa which
therefore requires inversion of the system.

As detailed further down below, backscattering can be neglected for very
fast electrons which is known as forward scattering approximation. This results
in $\bb T$ begin lower triangular if the spheres are sorted in ascending
order along $\bb e_z$. Inversion is therefore no longer necessary and
calculations can be performed sequentially one atom after the other.

\begin{figure}[h!]
  \centering
  \includegraphics[height=0.2\textheight]{figures/qdot2_approxCrop.png}
\captionof{figure}{Two-level forward scattering approximation using the T-matrix approach.
Neglecting backscattering, scattering from the second scatterer located at
distance $kd$ from the first scatterer can be approximated by the sum of
1) the kinematic scattering to the incident beam and
2) the secondary scattering in response to the kinematic scattering from
the first scatterer.}\label{fig:qdot2_approx}
\end{figure}


Since $\bb A_0=\bb L$ represents single scattering, we can establish that
$\bb A_1=\bb T\bb A_0$ accounts for secondary scattering.
Similarly, outward scattering ampltiudes from sphere $p$ can be written :
%
\begin{eqnarray}
  \bb b_{p} &=&
      \bb b_{p}^{(0)} + \sum_{q,z_q<z_p}\bb T_{pq}\bb b_{q}^{(0)}  \nonumber\\
    &&~+\bb T_{pq}\sum_{q,z_q<z_p}\bb T_{qr}\sum_{r,z_r<z_q}\bb b_{r}^{(0)} + ..\nonumber\\
    &=& \sum_{n=0} \bb T^n \bb b_p^{(0)} = \sum_{n=1}\bb b_p^{(n)}  \label{eq:multiple_scattering}
\end{eqnarray}
%
where the first term accounts for kinematic scattering, the second term for
secondary scattering, the third term three time scattering and so on.
This is a similar development to the Korringa-Kohn-Rostoker (KKR) theory of
multiple scattering~\cite{Korringa1947,Kohn1954,Korringa1994}.
This forward multiple scattering picture in the case of a 2 body problem is
illustrated in figure~\ref{fig:qdot2_approx}.
From a compuational point of view,~\eqref{eq:multiple_scattering} may offer an
advantage over the full forward scattering approximation if only a few n-time
scattering terms are necessary. Indeed, since each term in the expansion depend
on precomputed coefficients $b_{p;lm}^{(0)}$, the $b_{p;lm}^{(n)}$ coefficients
for the n-time scattering term can be massively parallelized for each atom.


\subsection{Scattering probabilties}

The probabilily of an electron to be scattered elastically $n$ times can be
estimated classically from ballistic arguments using a continuous model of matter.
It can be established~\cite{Egerton2011d} that the probabilty of an electron to
be elastically scattered $n$ times after passing through an amorphous sample of
thickness $z$ follows a Poisson distribution statistics
$P_e^n=\frac{1}{n!}(z/l_e)^ne^{-z/l_e}$
where $l_e$ is the elastic mean free path.

We may use the scattering cross section to define the probability of an electron
being scattered. If $S$ is the area over which the specimen is illuminated and
$z$ the thickness of the specimen, the incident plane wave can be normalized by
$|A|^2=1/Sz$. The flow of electrons per unit time per unit area~\cite{Vainshtein1964}
is then $J_0=\hbar k_0/m |A|^2=v_0/Sz$ where $v_0$ is the speed of the incident
electron and $J_0 S$ is the number of electron illuminating the specimen per second.
Besides, by definition $J_0\sigma$ is the number of electrons scattered per second
and it takes $\Delta t=z/v_0$ for an electron to go through the specimen,
so that $\sigma J_0z/v_0$ is the probability of an electron to be scattered.
Therefore :
%
\begin{equation*}
  P_{scat}=\frac{\sigma}{S}
\end{equation*}
%
where $S$ can be seen as the surface illuminated in selected area electron
diffraction (SAED). When performing a multislice simulation, $S$ is the area of
the simulated domain (transverse super cell if performing a periodic simulation).

Let's define $f_n$ the scattering amplitudes obtained by computing scattering
from the wave being scattered $n$ times. It can readily be established that :
%
\begin{eqnarray}
    f(\theta) &=& \sum_{n=1}^N f_n(\theta)  \nonumber\\
    \sigma    &=& \sum_{n=1}^N \sigma_n     \nonumber\\
    \sigma_n  &=& \lvert f_n\rvert^{2} + 2\Re f_n\sum_{m>n}^Nf_m^{*}\label{eq:sigma_n}\\\nonumber
\end{eqnarray}
%
where $P_n=\sigma_n/S$ can be defined as the probability of an electron to be
scattered $n$ times. Since contributions from multiple scattering terms should
normally be in ascending order, this definition ensures that the probability of
scattering of order $n$ increases as soon as the corresponding term $m$-times
scattering start contributing to the scattering amplitudes.

The probability of an electron to not being scattered is naturally $P_{coh}=1-P_{scat}$.
For an very large number $N$ of scatterers regularly spaced by distance
$dz$, using the average cross section $\sigma_a=\sigma/N$, the average scattering
probability to be scattered over distance $dz$ would be
$P(dz)=\sigma_a\rho dz=dz/l_e$ where $\rho=1/Sdz$ is the density since since $Sdz$
contains only one scatterer and $l_e=1/\sigma_a\rho$ is the mean free path.
This is consistent with~\cite{Latychevskaia2019}.



\subsection{First Born approximation and kinematic scattering}
Assuming normal incidence $\theta_i=0$ so that $e_p=e^{jk_0d_p}$
and noting that the Ewald sphere can be represented by
$\bb q = K\left(\sin\theta\cos\phi,\sin\theta\sin\phi,1-\cos\theta\right)$
in transfer vector momentum space,
$K=1/\lambda$ begin the wave number in crystallographic convention,
keeping only the kinematic term in~\eqref{eq:multiple_scattering}
and injecting in the far field~\eqref{eq:f_theta} gives :
%
\begin{equation}\label{eq:TmatrixKin}
  f(\theta,\phi) = \sum_{p=1}^{N}f_p^{(e)}e^{2j\pi \bb q\cdot \bb d_p}
\end{equation}
%
where $f_p^{(e)}$ is the scattering amplitude of sphere $p$ in the
First Born approximation also known as the form factor.
Equation~\eqref{eq:TmatrixKin} does correspond to the standard kinematic
formula for the structure factor traditionnally used in crystallography.
Note that the kinematic approximatio is nothing less than the first first Born
approximation applied to the whole assembly of atoms. It will be seen further
down below that it is possible for the first Born approximation to hold at the
scatterer level while being invalid at the assembly level.





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Multislice : Multiple scattering
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Multiple scattering in multislice}

\begin{figure}[h!]
  \subfloat[]{\includegraphics[height=0.25\textwidth]{figs/readings/cowley/parabola.eps}\label{fig:MS_parabola}}
  \subfloat[]{\includegraphics[height=0.25\textwidth]{figs/readings/cowley/scat3_1.eps}\label{fig:MS_scattering}}
\caption{Multiple scattering in multislice.
a) Distance $\zeta^{(MS)}$ to the Ewald paraboloid(solid curve) as approximated by
multislice and distance $\zeta^{(BW)}$ to the Ewald sphere(dashed curve) known as the
excitation error in the blochwave theory. Point P is the projection of
reciprocal point $(u_n,w_n)$ onto the Ewald paraboloid.
b) Multiple scattering in reciprocal space for $N=3$ slices located at $z_1, z_2, z_3$.
The beam is scattered by $(h_1,0)$, then $(h_2,0)$ and then $(h_N,0)$ which
results in an overall contribution to reflection $h$ on the diffraction pattern.
The open blue circles show the subsequent excitation errors $\zeta^{(i)}$.
}%\label{fig:MS_scattering}
\end{figure}

In multislice, the forward scattering approximation is used and the
potential discretized in slices which are propagated from one slice to
the other using Fresnel propagator.

A multiple scattering interpretation by the multislice has been
proposed~\cite{CowleyMoodie1957} which, although analgous to the
one presented above, differs in that it is stated in reciprocal space.
The expression for the scattering ampltiude $f(h,k)$ of beam $h,k$ is
proportional to the following expression :
%
\begin{align}
  f(h,k) \propto
    &\sum_{l}\sum_{h_1}\sum_{k_1}\sum_{l_1}..
      \sum_{h_{N-1}}\sum_{k_{N-1}}\sum_{l_{N-1}}Q_{h_1,k_1,l_1}..\nonumber\\
    &Q_{h_{N-1},k_{N-1},l_{N-1}}Q\Bigl(h-h_u,k-k_v,l-l_w\Bigr)   \nonumber\\
    &~~~~~~e^{-2\pi j\bigl(H\zeta - \Delta z\sum_{n=1}^{N-1}\zeta_n\bigr)}\label{eq:fhk_multi}
\end{align}
%
where $h=\sum_{n=1}^N h_n$, $k=\sum_{n=1}^N k_n$,
$h_u=\sum_{n=1}^{N-1} h_n$, $k_v=\sum_{n=1}^{N-1} k_n$, $l_w=\sum_{n=1}^{N-1} l_n$,
$H=N\Delta z$ is the total thickness of the sample,
$N$ the number of slices of thickness $\Delta z$,
$Q_{h,k,l}=-j/\Delta z\delta_{h,k}e^{-2j\pi l_n z_n/c} + \sigma F_{h,k,l}$,
$F_{h,k,l}$ is the structure factor,
$\sigma=2\pi m_eh/\lambda$ the interaction parameter,
$\zeta$ the excitation error of beam $(h,k,l)$ and
$\zeta_n$ is the excitation error of beam
$\left(\sum_{r=1}^{n} h_r,\sum_{r=1}^n l_r\right)$.
The excitation error is exprred as :
%
\begin{equation}\label{eq:zeta}
  \zeta = \frac{1}{2K}\Bigl(\frac{h}{a^2} + \frac{k}{b^2}\Bigr) - \frac{l}{c}
\end{equation}
%
where $a$, $b$ and $c$ are the lattice constants of the crystal and
$K=1/\lambda$ the wave number.
Equation~\eqref{eq:zeta} is the longitudinal distance of beam $(h,k,l)$ to
the paraboloid shown in figure~\ref{fig:MS_parabola}.
This paraboloid is a very accurate representation of the Ewald sphere for
large wave number $K$. $\zeta$ is therefore very close to the excitation
error commonly defined in crystallography.

From equation~\eqref{eq:fhk_multi} it is possible to gather terms in
powers of $Q_{0,0,0}^{N-n}$ into $f_{h,k}^{(n)}$ which corresponds to the
incident beam scattered $n$ times before contributin to reflection $h,k$.
The term $Q_{0,0,0}^N$ only appears for $h=k=0$ and corresponds to the
unscattered direct beam.
There are $N$ terms involving $Q_{0,0,0}^{N-1}$ depending on which slice
the single scattering event took place.
There are $N(N-1)/2$ terms involving $Q_{0,0,0}^{N-2}$ depending on which
pair of slices are considered the two level scattering process and so on.
This multiple scattering picture is illustrated in 2D in figure~\ref{fig:MS_scattering}
for a case with $N=3$ and using only beams in the zero order Laue zone (ZOLZ)
$l_i=0$.

Using only ZOLZ beams, $f_{h,k}^{(1)}$, $(h,k)\neq (0,0)$ is expanded as :
\begin{equation}\label{eq:MSkin}
  f_{h,k}^{(1)} \propto F_{h,k,0}\sum_{m=1}^N e^{-2j\pi m\Delta z\zeta}
\end{equation}
%
which is the well known kinematic scattering regime where the sum converges to
the standard Ewald sphere curvature factor $\sin(\pi\zeta H)/\pi\zeta$ for
infinitly thick slices $N\rightarrow\infty,\Delta z\rightarrow 0$, $N\Delta z=H$


For a 2 level scattering using only ZOLZ beams,
$f_h^{(2)}$ would expanded as (written in 2D here) :
%
\begin{eqnarray}
  f_h^{(2)} &\propto&\sum_{h_1}F_{h_1,0}F_{h-h_1,0} \nonumber\\
    && \sum_{m_1=1}^N\sum_{m_2>m_1}^N e^{-2j\pi\Delta z
      \bigl(m_1\zeta_1+m_2\left(\zeta-\zeta_1\right)\bigr)} \label{eq:MSdual}
\end{eqnarray}
%









%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Numerical results
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Application and Results}

Although very efficient open source implementations are available for
electromagnetics~\cite{celes2017,pygmm2020}, an implementation suited for
solving Schr{\"o}dinger's equation has been made available~\cite{pyscat}.

\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[height=0.27\textwidth]{figures/addth_error.png}\label{fig:TmatrixError1}}
  \subfloat[]{\includegraphics[height=0.25\textwidth]{figures/Tmatrix_cv.png}\label{fig:TmatrixError2}}
\caption{
a) Error between $\hl Y_{lm}$ for $l=4$ and $m=2$ computed at the origin and
using the translational addition theorem $\bb d_p = (0,3,5)$ with $\nu_{max}=10$.
The circle represent spheres of radius 1. Color axis in logscale.
b) Continuity error at the sphere boundaries in the T-matrix with increasing
order. For this example $N=4$ and $ka_{max}=4$.
}\label{fig:TmatrixError}
\end{figure}

In practice, the sums over~(\ref{eq:aplm},\ref{eq:bplm}) have to be truncated to
a maximum integer order $l_{max}$.
A rule to obtain accurate results is to take $l_{max}$ a few integer
above the maximum value of $ka$ since the spherical Bessel functions of
order $l$ have enough ripples to capture the periodicity of the incident wave
in the vicinity of the sphere. Moreover, the translational addition theorem
provides an approximation of the spherical Hankel functions with decreasing
accuracy from the center at which it is written similarly to a Taylor's expansion.
This is illustrated in figure~\ref{fig:TmatrixError}a where the error between
$\hl Y_{lm}$ for $l=4$ and $m=2$ computed at the origin and using the
translational addition theorem with $\bb d_p = (0,3,5)$ and $\nu_{max}=10$ is
displayed in logscale. This allows for distances between spheres to be arbitrarily large.
The criteria for selecting $l_{max}$ is best evaluated by assessing the
continuity of the wave functions at the sphere boundaries as shown in
figure~\ref{fig:TmatrixError} for $N=4$ and $ka_{max}=4$.
This is also used to validate the correctness of the implementation
since it can be seen that machine accuracy can be reached when increasing
the order.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Validity Forward scattering
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Validity of forward scattering and phase grating approximations
 for light atoms}



In the case of very fast electrons typically used in transmission electron
microscopes $E=50-300keV$. Inclusion of relativistic effects result in
$\lambda=0.025\text{\AA}@200keV$ which will be assumed from now on unless stated
otherwise.

\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/qdotSphereSingle_shells_pot1.eps}
  \label{fig:IAMa}}\\
  \vspace{-1.1em}
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/qdotSphereSingle_shells_fka1.eps}
  \label{fig:IAMb}}
\caption{
a) Electrostatic potential created by an atom of carbone with
the IAM (blue solid line),
fitted single screened coulomb potential (blue dahsed line),
fitted Coulomb potential with offset (red dashed line).
The blue patches show a multi-shell approximation model which can be used
to represent the potential using a T-matrix approach.
b) Scattering amplitude in the Born approximation for the multi-shell model
with increasing truncation radius $ka_{max}$. The electron form factors factors
is shown as dashed line.
}\label{fig:IAM}
\end{figure}

In the IAM, the Coulomb potential is created by the charge of the nucleus and its
electron cloud. It is fitted with a sum of 3 screened Coulomb potential and
3 Gaussian terms ~\cite{Kirkland2019}.
For typical light atoms such as commonly found in organic compounds, a single
screend Coulomb potential term can be a pretty good approximation as shown in
figure~\ref{fig:IAMa}. The solution to Schr{\"o}dinger's equation in such a
potential can only be solved perturbatively~\cite{Muller1965} and is beyond the
scope of this document. However, indicative values for $k_p$ and $ka_p$
can be used with a multi-shell representation as shown as blue patches on
figure~\ref{fig:IAM}a. Although the range of the screened Coulomb potential
is theoretically infinite, it can reliably be truncated to radius $ka$.
In figure~\ref{fig:IAMb} the multi-shell scattering amplitudes in the Born
approximation are shown for increasing values of truncation radius.
A satisfactory agreement with the electron diffraction scattering factors is obtained for normalized raidus
as large as $ka=350$ to account for the proper low angle representation
although the potential is very small at such radius.


\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/TmatrixSingleS.eps}\label{fig:TmatrixSingleS}}\\
  \vspace{-1.1em}
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/TmatrixSingleF.eps}\label{fig:TmatrixSingleF}}\\
\caption{
a) Total scattering cross section $\sigma$ at $200keV$ for a few
values of $n_p$ over a range of normalized radius $ka$. The dark blue
curve shows the location of the carbone spherical shells .
b) Shape of the scattering amplitude for normalized radius
$ka=5$, $n_p=1.025$ (blue)
and $ka=40$, $n_p=1.001$(green).
Also shown, the Born approximation (dashed lines) and
the phase grating approximation used in multislice (dash-dotted lines).
}%\label{fig:TmatrixSingleScat}
\end{figure}

As mentioned above, such large radius would be quite hard to simulate with
the T-matrix due to the large orders to be included. However,the medium radius
range should provide a reasonable picture of dynamical scattering.
Figure~\ref{fig:TmatrixSingleS} shows the total scattering cross section of
a single sphere with increasing radius for a range of values of $n_p$. The dark
blue curve shows the locations of the spherical shell for Carbone. It becomes almost
flat from $ka=30$, $n_p=1.001$ although slightly keeps increasing to reach the
asymptotic value $\sigma\approx 0.0035\text{\AA}^2$ which is almost identical to the
average elastic cross section for real carbone in the Born approximation~\cite{Latychevskaia2019}.
Figure~\ref{fig:TmatrixSingleF} shows the shape of the far field
amplitudes for 2 parameter sets of $ka$,$n_p$ indicative of Carbone shells.
The Born approximation captures very well the shape for both sets
although some minor differences appear at large angles for $ka=5$, $n_p=1.025$
The phase grating approximation provide some improvement at low angles.

\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[height=0.26\textwidth]{figures/qdotSphereArray2approx_kakp_uncoupled.png}\label{fig:TmatrixApproxKinematic}}
  \subfloat[]{\includegraphics[height=0.26\textwidth]{figures/qdotSphereArray2approx_kakp_forward.png}\label{fig:TmatrixApproxForward}}
\caption{$(ka,k_p)$ map(color axis in logscale) of the error of $b_{p;lm}$
for a 2 scatterer system using the
a) Kinematic scattering approximation.
b) Forward scattering approximation.
The blue dot correspond to the location of the spherical shells of Carbone
atom at $E=200keV$.}
\end{figure}

Figure~\ref{fig:TmatrixApproxKinematic} and ~\ref{fig:TmatrixApproxForward} show
for a 2 body problem the error in a $(ka,n_p)$ map in computing the coefficients
$err(b_{p;l,m})=\sum_{p;l,m} \lvert b_{p;l,m} - b_{p;l,m}^{approx} \rvert)$
as a result of using the kinematic and forward approximations respectively.
For this case an value of $kd=3ka$ is used which should represent inter-atomic distances.
Overall it is very clear that the forward scattering approximation is very accurate
over all range of parameter sets for carbone which is expected since there is very
little back backscattering beyond $90^{\circ}$. On the other hand the kinematic
approximation does not appear quite as good even for this mere 2 dody problem.
Although not shown here, both the kinematic and forward scattering approximation
tend to work slightly better with increasing distances $kd$ since coupling between the
the spheres is reduced.
 It is therefore less likely to affect scattering from the other spheres.
The low values of $n_p$ result in overall good approximation of both the uncoupled and forward scattering approximation. This is an anticipated result since for weak potentials, the kinematic approximation is more valid.
The uncoupled approximation improves with small radii since Small $ka$ result in small scattering cross section,
On the other hand the forward scattering approximation improves with larger values of $ka$ since backward scattering is less likely for large $ka$.


\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/qdotSphereArray2approx_kakp_bp.eps}\label{fig:TmatrixApprox_bp}}\\
  \vspace{-1.1em}
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/qdotSphereArray2approx_kakp_ff.eps}\label{fig:TmatrixApprox_ff}}
\caption{
a) Complex space scattering coefficients $b_{p;l,m}$ for a 2 body problem for
$n_p=1.01$, $kd=3ka$ with increasing radius $ka$.
Only the coefficients for sphere $p=2$ and $m=0$ are shown.
The coefficients were computed from full T-matrix (open circles), the forward
scattering approximation (squares) and the kinematic approximation (diamonds).
b) Comparison of far field scattering amplitudes for $N=2$, $ka=30$, $n_p=1.01$,
$kd=2ka$ using full T-matrix (solid blue), forward approximation(green dashed)
and kinematic approximation (red dashed-dotted).}
\end{figure}

Figure~\ref{fig:TmatrixApprox_bp} shows the scattering coefficients $b_{p;l,m}$
in complex space for a this 2 body problem where $n_p=1.01$, $kd=3ka$
while increasing radius $ka$ (up to $ka=15$) for a selected set of orders $l$.
Only the coefficients for sphere $p=2$ are shown since it is the mostly affected
sphere by the approximations. Only $m=0$ coefficients are used since under
planar illumination this configuration has azimuthal symmetry.
The coefficients are computed using the full T-matrix, the forward
scattering approximation and the kinematic approximation. In order to get this
spiralling galaxy picture, the coefficients where divided by the phase factor at
sphere $p$, i.e. $b_{p;lm}e^{jkd}$. The arms of the galaxy are rotated by $\pi/2$
from one order to the other as a result of the $j^l$ factor in the spherical expansion
of the incident plane wave. All the coefficients increase with $ka$ as a result of
the increasing scattering cross section with $ka$. For a given $ka$, the strongest
is contributing orders are around $l=ka$ as a direct manifestation of the convergence
behaviour presented above. It can be observed that the kinematic approximation
error increases with the radius while the forward approximation is very accurate
across all radius.

Figure~\ref{fig:TmatrixApprox_ff} shows a comparison of the computed far field
scattering amplitudes for $N=2$, $ka=30$, $n_p=1.01$,$kd=2ka$ using the full
T-matrix, the forward approximation and the kinematic approximation. The peaks and
valleys are both due to the single scattering profile of the constant sphere and
the interferometric path length $e^{jkd}$. It is already possible to notice
that the coupled problem as a slight average effect ove the kinematic pattern, a
well known feature of dynamical diffraction.




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Application of Multiple scattering
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Successive multiple scattering approximations}

Finally, we consider an array of $N$ identical scatterers regularly spaced by
$kd=3ka$ under normal illumination and consider the successive multiple scattering
approach. This is an extreme channelling case where dynamical scattering is
anticipated to be strong.

\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/TmatrixApproxErr.eps}\label{fig:TmatrixApproxErr}}
  \vspace{-1.1em}
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/TmatrixApproxErr_n.eps}\label{fig:TmatrixApproxErr_n}}\\
\caption{
a) Error on the scattering amplitudes coefficients with increasing number of spheres
$N$ for $ka=7$, $n_p=1.001$, $kdka=3$. The forward (squares), kinematic(diamonds)
and secondary (triangles) approximations are shown as well as the successive
$n$ times multiple scattering approximations (colored dashed lines).
b) Error on the scattering amplitudes coefficients with increasing successive
approximations for $ka=7$, $kdka=3$ and $N=100$ spheres while varying $n_p$.
}%\label{fig:TmatrixApproxErr}
\end{figure}

Figure~\ref{fig:TmatrixApproxErr} and~\ref{fig:TmatrixApproxErr_n} show the
evolution of the error on scattering amplitude coefficients for an increasing
number of spheres while also varying the number of successive approximations.
for a fixed parameter set $ka=7$, $kdka=3$.
The forward scattering approximation becomes worse and worse for increasing
numbers of spheres as a result of accumulated errors. This is limitation of
a forward scheme such as the one performed by multislice which is only accurate
up to a certain simulated thickness.
Overall the successive approximation schemes naturally converge to the forward
approximation for sufficiently large $n$. However, more orders need to be included
as the number of spheres (or thickness) increases. This is similar to other
multiple scattering approaches. For example, in the case of a 2 beam
configuration, it was shown~\cite{ref:CowleyMoodie1957} that the scattered
beam could be expressed using expansion~\ref{eq:fhk_multi} considering only
the scattering terms of the the primary beam $n=1,3,5..$. The famous 2-beam
analytical scattering expression is obtained as the sum of the infinite series.



\begin{figure}[h!]
  \centering
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/Tmatrix_Pn.eps}\label{fig:Tmatrix_Pn}}\\
  \vspace{-1.1em}
  \subfloat[]{\includegraphics[height=\figsca\textwidth]{figures/Tmatrix_fn.eps}\label{fig:Tmatrix_fn}}
  \caption{
a) Scattering probabilities (dashed colored lines) of $n$ times scattering,
kinematic(cyan solid line), dynamic scattering(blue solid line) and
total scattering (black solid) probabilties.
The total scattering  probabilty following the Poisson distribution using the average
scattering cross section is shown as dashed-dotted line.
Probabilties have been integrated over angular distribution. Values were $ka=7$,
$n_p=1.01$, $ka=3kd$.
b) scattering amplitudes $f_n$ associated with $n$ times scattering for $ka=7$,
$n_p=1.01$ and $N=15$. The total scattering ampltiude $f=\sum_n f_n $ is shown
in solid black.
}%\label{fig:10}
\end{figure}

Figure~\ref{fig:Tmatrix_Pn} shows the scattering probabilities of $n$ times scattering
for $ka=7$,$n_p=1.01$, $ka=3kd$ with increasing $N$.
The dynamic scattering probabily $P_{dyn}=\sum_{n>1}P_n$ and the kinematic
probability as well as the total scattering probabilties are shown.
It seems that all multiple scattering terms increase with number of spheres in
contrast to the ballistic picture of the Poisson distribution~\cite{} also shown
as dashed-dotted lines using the average scattering cross section.
The main reason for this is that the ballistic picture ignores the effect
of interference which drastically affects the overall scattering process.  

Figure~\ref{fig:Tmatrix_fn} shows the scattering amplitudes $f_n$ associated with
$n$ times scattering for $ka=7$, $n_p=1.01$ and $N=15$. The scattering amplitudes
have similar shapes which mostly contrbitutes to constructive interference although
sligth peak misalgnements can be seen.


% \begin{figure}[h!]
%   \centering
%   \subfloat[]{\includegraphics[height=0.35\textwidth]{figures/qdot_vs_multi.eps}\label{fig:MSvsTmatrix2}}\\
%   \vspace{-1.1em}
%   \subfloat[]{\includegraphics[height=0.35\textwidth]{figures/qdot_vs_multi.eps}\label{fig:MSvsTmatrix10}}
% \caption{Comparison of multislice and Tmatrix
% $keV=50$, $ka=11$, $kd=3ka$, $k_p=1.001$.
% a)$N=2$ spheres,
% b)$N=10$ spheres.
% }%\label{fig:MSvsTmatrix}
% \end{figure}
%
% Figure~\ref{fig:MSvsTmatrix2} and~\ref{fig:MSvsTmatrix10} shows a comparison between running a multislice
% and the T-matrix. Since multislice assumes periodic boundary conditions in the
% each slice, very large padding was used to simulate the effect of the crystal.
% The projected potential can be readily calculated for a constant potential sphere
% as $V_{p;z}(\rho) = 2V_p\sqrt{a^2-\left(\rho-\rho_p\right)^2}$
% where $\rho$ and $\rho_p$
% are the polar radius in the $(x,y)$ plane of the slices.
%
% \loremlines{20}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% Conclusion and Perspective
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusion and perspective}

An alternative approach based on the T-matrix has been applied to the
scattering of fast electrons by light-atom structures.
The validity of important approximations used in multislice has been
discussed and a multiple scattering approximation framework has been proposed
and compared to other existing interpretations.

Although the spherically symmetric effective potential does not accurately
model the potential used in atoms, it was shown that the multiple scattering
interpretation should equally apply to the more accurate case of a screened
Coulomb potential. A possible inclusion of such a potential could be performed
by using a basis of radial functions solutions the Schr{\"o}dinger's equation
in a Yukawa potential such as produced by a variational or other numerical approach.
Since the T-matrix mainly relies on the spherical symmetry of the individual
scatterers, it can be adapted to any radial family of functions provided translational
coefficients can be computed numerically.
The main ultimate limitation of both this approach and the traditional
multislice lies in the use of the independent atom model which by definition
ignores the effect of bonding. While the multislice can be adapted at a
computational cost to bonding models such as Transferrable Aspherical Atom
Model (TAAM), the T-matrix presented here certainly cannot.
However, it is still an open question whether such bonding play an
important role in HEED structure determination of organic structures.

The advantage of a multiple scattering approximation approach is that it offers
both the possibility of a massively parallel computation of dynamical diffraction
while including incoherent inelastic scattering with a stochastic approach.
It is indeed strongly anticipated that inelastic scattering has a dramatic
mitigation effect of dynamical diffraction even when energy filters are used.
This aspect is currently under investigation.
